{
  "config": {
    "model_name": "llama-70b",
    "num_decoder_layers": 80,
    "sequence_length": 4096,
    "min_batch_size": 128,
    "max_batch_size": 128,
    "optimal_batch_size": 128,
    "d_model": 8192,
    "d_hidden": 22016,
    "max_pipeline_stages": 8,
    "min_memory_utilization": 0.5
  },
  "solution": {
    "objective_value": 23551.516254691283,
    "batch_size": 128,
    "throughput_tokens_per_sec": 23551.516254691283,
    "cost_per_hour": 195.83999999999997,
    "cost_per_token": 2.3098300513523807e-06,
    "meets_cost_threshold": true,
    "tp_configuration": {
      "V100": 8
    },
    "gpu_assignments": [
      {
        "gpu_type": "V100",
        "partition_id": 112,
        "gpu_ids": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7
        ],
        "global_gpu_ids": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7
        ],
        "tp_degree": 8,
        "start_layer": 1,
        "end_layer": 10,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 113,
        "gpu_ids": [
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "global_gpu_ids": [
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "tp_degree": 8,
        "start_layer": 11,
        "end_layer": 20,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 114,
        "gpu_ids": [
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23
        ],
        "global_gpu_ids": [
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23
        ],
        "tp_degree": 8,
        "start_layer": 21,
        "end_layer": 30,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 115,
        "gpu_ids": [
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31
        ],
        "global_gpu_ids": [
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31
        ],
        "tp_degree": 8,
        "start_layer": 31,
        "end_layer": 40,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 116,
        "gpu_ids": [
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39
        ],
        "global_gpu_ids": [
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39
        ],
        "tp_degree": 8,
        "start_layer": 41,
        "end_layer": 50,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 117,
        "gpu_ids": [
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47
        ],
        "global_gpu_ids": [
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47
        ],
        "tp_degree": 8,
        "start_layer": 51,
        "end_layer": 60,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 119,
        "gpu_ids": [
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63
        ],
        "global_gpu_ids": [
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63
        ],
        "tp_degree": 8,
        "start_layer": 61,
        "end_layer": 70,
        "segment_size": 10,
        "throughput": 23551.516254691283
      },
      {
        "gpu_type": "V100",
        "partition_id": 118,
        "gpu_ids": [
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55
        ],
        "global_gpu_ids": [
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55
        ],
        "tp_degree": 8,
        "start_layer": 71,
        "end_layer": 80,
        "segment_size": 10,
        "throughput": 23551.516254691283
      }
    ],
    "network_connections": [
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 112,
          "start_layer": 1,
          "end_layer": 10
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 113,
          "start_layer": 11,
          "end_layer": 20
        },
        "throughput": 22937600.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 113,
          "start_layer": 11,
          "end_layer": 20
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 114,
          "start_layer": 21,
          "end_layer": 30
        },
        "throughput": 22937600.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 114,
          "start_layer": 21,
          "end_layer": 30
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 115,
          "start_layer": 31,
          "end_layer": 40
        },
        "throughput": 22937600.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 115,
          "start_layer": 31,
          "end_layer": 40
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 116,
          "start_layer": 41,
          "end_layer": 50
        },
        "throughput": 22937600.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 116,
          "start_layer": 41,
          "end_layer": 50
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 117,
          "start_layer": 51,
          "end_layer": 60
        },
        "throughput": 22937600.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 117,
          "start_layer": 51,
          "end_layer": 60
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 119,
          "start_layer": 61,
          "end_layer": 70
        },
        "throughput": 22937600.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 119,
          "start_layer": 61,
          "end_layer": 70
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 118,
          "start_layer": 71,
          "end_layer": 80
        },
        "throughput": 22937600.0
      }
    ],
    "solve_status": 2,
    "num_pipeline_stages": 8
  }
}